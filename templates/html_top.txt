<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>ملف إنجاز المعلم - نظام الشواهد</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&display=swap" rel="stylesheet">

<!-- سيتم إدراج CSS هنا من css.txt عبر المولّد -->
<style>
{{CSS}}
</style>

</head>
<body>

<div class="page">

<header>
  <div class="app-title">
    <h1>ملف إنجاز المعلم - نظام الشواهد</h1>
    <div class="app-subtitle">
      رفع شواهد المعايير، إنشاء صفحات HTML تلقائيًا على GitHub، وتوليد QR داخل ملف الإنجاز.
    </div>
    <div class="teacher-label">
      المستخدم الحالي: <span id="teacher-username"></span>
      <span id="github-status" style="margin-right:6px;font-size:10px;color:#9ca3af;"></span>
    </div>
  </div>

  <div class="header-spacer"></div>

  <button class="btn btn-ghost" id="github-btn" type="button">إعداد GitHub</button>
  <button class="btn btn-ghost" id="admin-btn" style="display:none;" type="button">لوحة التحكم</button>
  <button class="btn btn-ghost" type="button" onclick="logout()">تسجيل الخروج</button>
  <button class="btn btn-primary" type="button" id="btn-generate">توليد ملف الإنجاز النهائي</button>
</header>

<main>
  <section class="grid" id="criteria-grid"></section>

  <div class="footer-actions">
    <span class="progress" id="global-status">جارٍ تحميل القالب template.pptx...</span>
  </div>

  <section class="qr-preview" id="qr-section" style="display:none;">
    <div style="display:flex;align-items:center;gap:8px;margin-bottom:8px;">
      <strong>معاينة رموز QR لكل معيار</strong>
      <span class="small">تم رفع صفحات HTML على GitHub وربط كل معيار برابط خاص.</span>
    </div>
    <div class="qr-grid" id="qr-grid"></div>
  </section>
</main>

<!-- النوافذ المنبثقة -->
<div id="teacherPopup">
  <div class="popup-inner">
    <h3>إدخال اسم المعلم</h3>
    <p>أدخل اسم المعلم، ثم سيتم إنشاء الصفحات وملف الإنجاز تلقائيًا.</p>
    <input id="teacherNameInput" class="popup-input" style="direction:rtl;" placeholder="مثال: سعود الشريف">
    <div class="popup-buttons">
      <button class="btn-confirm" onclick="confirmTeacherName()">متابعة</button>
      <button class="btn-cancel" onclick="closeTeacherPopup()">إلغاء</button>
    </div>
  </div>
</div>

<div id="githubPopup">
  <div class="popup-inner">
    <h3>إعداد GitHub Token</h3>
    <p>أدخل Personal Access Token الذي لديه صلاحية الكتابة على المستودع MOE-SF فقط.</p>
    <input id="githubTokenInput" class="popup-input" placeholder="ghp_..." autocomplete="off">
    <div class="popup-buttons">
      <button class="btn-confirm" onclick="saveGithubToken()">حفظ</button>
      <button class="btn-cancel" onclick="closeGithubPopup()">إغلاق</button>
    </div>
  </div>
</div>

<script>
